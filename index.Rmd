---
title: "EDLD 610 Final Project Dashboard for Jenn Lewis"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(dplyr)
library(rio)
library(here)
library(ggrepel)



data1 <- import(here("data", "Full_Data.csv")) 

```
Sidebar Title {.sidebar}
===========================
## About the Data

These data visualizations are intended for an academic audience.

The data used in these visualizations was simulated from existing data using the synthpop package. The details below describe the methods of the original data.

Participants:
Participants were 79 women (MeanAge=32.66, SD=5.22) recruited from community sources including a developmental database maintained by the psychology department, craigslist, and local mental health agencies and services. 

Participants were classified as either healthy controls (n=37), women with no mental health symptoms or as women with elevated symptoms of Borderline Personality Disorder (BPD, n=42)

Procedures:
Participants were assessed in a lab where they completed tasks and self-report measures. Tasks included a baseline Heart Rate Variability measurement, a behavioral measurement of Inhibitory Control as assessed through the Stroop Color-Word task and various Self-Report measures on mental health symptoms.


# Visualization 1

Column {data-width=500 .tabset}
-----------------------------------------------------------------------

### Version 1

```{r}

#Clean Data to proper format
HRV1 <- data1 %>%
  gather(key = HRV_Segment, value = RSA, RSA_1, RSA_2, RSA_3, RSA_4, RSA_5, RSA_6, RSA_7, RSA_8, na.rm =TRUE) %>%
  select(HRV_Segment, RSA, Group) %>%
  filter(Group != "NA") %>%
  group_by(Group, HRV_Segment) %>%
  summarise(RSA = mean(RSA)) 

HRV1 %>%
  ggplot(aes(HRV_Segment, RSA, color = Group)) +
  geom_line() +
  theme_minimal() +
  #ylim(0, 7) +
  labs(y = "HRV",
       x = "Segment",
       title = "HRV across Time for BPD vs Control Group")
```


> This was the first attempt I made in developing this plot.  I quickly realized that Group needed to be recoded as a factor. I also noticed that the labels for the X Axis are redundanct and would be better as numbers only.  So in my next iteration, I will remove the "RSA_" from my axis labels and I will recode Group as a factor. 

### Version 2

```{r}
#Convert Group to Factor

HRV1$Group <- as.factor(HRV1$Group)

HRV1 <- HRV1 %>%
mutate(HRV_Segment = recode(HRV_Segment,
                              "RSA_1" = "1",
                              "RSA_2" = "2",
                              "RSA_3" = "3",
                              "RSA_4" = "4",
                              "RSA_5" = "5",
                              "RSA_6" = "6",
                              "RSA_7" = "7",
                              "RSA_8" = "8"))
HRV1 %>%
  ggplot(aes(HRV_Segment, RSA, color = Group)) +
  geom_line() +
  theme_minimal() +
  #ylim(0, 7) +
  labs(y = "HRV",
       x = "Segment",
       title = "HRV across Time for BPD vs Control Group")
```

> After making these changes I saw improvements, but there was also another obvious problem that popped up - no data showing.  I sought out some help for this and discovered that I was mapping things in the aesthetics wrong.  I needed to define "group" rather than color is the main plot aesthetic and define color in the geom.

### Version 3

```{r}

HRV1 %>%
  ggplot(aes(HRV_Segment, RSA, group = Group)) +
  geom_line(aes(color = Group)) +
  theme_minimal() +
  #ylim(0, 7) +
  labs(y = "HRV",
       x = "Segment",
       title = "HRV across Time for BPD vs Control Group")

```

> Wahoo! Data has appeared.  At this point I feel like the visual is fairly successful, but can use some little tweaks to the design.  In my next batch of edits, I'll be defining the groups more clearly and adding some style changes.

Column {data-width=500}
-----------------------------------------------------------------------

### Final Version

```{r}
pal <- c(
  "1" = "orange",
  "2" = "purple"
)

HRV1$Group <- recode(HRV1$Group, '1' = "Control Group", '2' = "BPD Group")

HRV1 %>%
  ggplot(aes(HRV_Segment, RSA, group = Group)) +
  geom_line(aes(color = Group)) +
  theme_minimal() +
  scale_fill_manual(values = pal,
                    limit = names(pal)) +
  #ylim(0, 7) +
  labs(y = "HRV",
       x = "Segment (30 sec epochs)",
       title = "Heart Rate Variability Across Time for Women with Borderline Personality
       Disorder vs A Control Group")

```